<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sorting a Q-matrix for plotting in PopGenHelpR â€¢ PopGenHelpR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sorting a Q-matrix for plotting in PopGenHelpR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PopGenHelpR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Manual</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/PopGenHelpR_vignette.html">Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_heterozygosity.html">Choosing heterozygosity</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_PCA.html">Principal Component Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_createQmatrix.html">Creating a Q-matrix</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_sortQmatrix.html">Sorting a Q-matrix</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_MakingMaps.html">Making Maps</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_plotformatting.html">Formatting plots</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_benchmarking.html">Testing PopGen statistics</a></li>
    <li><a class="dropdown-item" href="../articles/PGH_viztests.html">Testing plotting arguments</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kfarleigh/PopGenHelpR"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sorting a Q-matrix for plotting in PopGenHelpR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kfarleigh/PopGenHelpR/blob/main/vignettes/articles/PopGenHelpR_sortQmatrix.Rmd" class="external-link"><code>vignettes/articles/PopGenHelpR_sortQmatrix.Rmd</code></a></small>
      <div class="d-none name"><code>PopGenHelpR_sortQmatrix.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>To sort a q-matrix of ancestry coefficients for use in the
<code>PopGenHelpR</code> function <code>Ancestry_barchart</code>.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>We often want to plot our structure-like ancestry bar chart in a
specific order. We may wish to visualize the ancestry chart by grouping
individuals of the same cluster together (e.g., ordered by cluster) or
by latitude or longitude (to match the pie chart map). To do this, we
can use the <code>ind.ord</code> and <code>pop.ord</code> arguments in
the <code>Ancestry_barchart</code> function.</p>
<div class="section level3">
<h3 id="load-the-data">Load the data<a class="anchor" aria-label="anchor" href="#load-the-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load PopGenHelpR</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kfarleigh.github.io/PopGenHelpR/">PopGenHelpR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Q_dat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First, we separate the list elements into two separate objects. The q-matrix (Qmat) and the locality information for each individual (Loc).</span></span>
<span><span class="va">Qmat</span> <span class="op">&lt;-</span> <span class="va">Q_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">Loc</span> <span class="op">&lt;-</span> <span class="va">Q_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="sorting-a-q-matrix">Sorting a Q-matrix<a class="anchor" aria-label="anchor" href="#sorting-a-q-matrix"></a>
</h2>
<p>First, we will create a vector that contains the order of individuals
and populations that we want our barcharts to be in. Then we use the
<code>ind.order</code> and <code>pop.order</code> arguments to specify
them. ***Note that the individuals and populations in
<code>ind.order</code> and <code>pop.order</code> must match the
individual and population names in your population assignment file (the
<code>pops</code> argument).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set orders</span></span>
<span><span class="va">Ind_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Pop_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Anc_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span><span class="va">Qmat</span>, <span class="va">Loc</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#f46d43'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#74add1'</span>, <span class="st">'#313695'</span><span class="op">)</span>, ind.order <span class="op">=</span> <span class="va">Ind_ord</span>, pop.order <span class="op">=</span> <span class="va">Pop_ord</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Anc_ord</span><span class="op">$</span><span class="va">`Individual Ancestry Plot`</span></span></code></pre></div>
<p><img src="Anc_barchart_sortedinds.png" width="600px" height="350px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Anc_ord</span><span class="op">$</span><span class="va">`Population Ancestry Plot`</span></span></code></pre></div>
<p><img src="Anc_barchart_sortedpops.png" width="600px" height="350px" style="display: block; margin: auto;"></p>
<p>We can do the same thing if our sample and population names are
character strings; just remember that <code>PopGenHelpR</code> requires
that your individual and population names are the same type; they must
be characters or numeric.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make the sample and population names characters</span></span>
<span><span class="va">Qmat_char</span> <span class="op">&lt;-</span> <span class="va">Qmat</span></span>
<span><span class="va">Qmat_char</span><span class="op">$</span><span class="va">Ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="va">Qmat_char</span><span class="op">$</span><span class="va">Ind</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Loc_char</span> <span class="op">&lt;-</span> <span class="va">Loc</span></span>
<span><span class="va">Loc_char</span><span class="op">$</span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="va">Loc_char</span><span class="op">$</span><span class="va">Sample</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span></span>
<span><span class="va">Loc_char</span><span class="op">$</span><span class="va">Population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Population"</span>, <span class="va">Loc_char</span><span class="op">$</span><span class="va">Population</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Ind_ord_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Sample'</span>, <span class="va">Ind_ord</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span></span>
<span><span class="va">Pop_ord_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Population'</span>, <span class="va">Pop_ord</span>, sep <span class="op">=</span> <span class="st">'_'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Anc_ord_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span><span class="va">Qmat_char</span>, <span class="va">Loc_char</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#f46d43'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#74add1'</span>, <span class="st">'#313695'</span><span class="op">)</span>, ind.order <span class="op">=</span> <span class="va">Ind_ord_char</span>, pop.order <span class="op">=</span> <span class="va">Pop_ord_char</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Anc_ord_char</span><span class="op">$</span><span class="va">`Individual Ancestry Plot`</span></span></code></pre></div>
<p><img src="Anc_barchart_sortedinds_char.png" width="600px" height="350px" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Anc_ord_char</span><span class="op">$</span><span class="va">`Population Ancestry Plot`</span></span></code></pre></div>
<p><img src="Anc_barchart_sortedpops_char.png" width="600px" height="350px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="questions">Questions???<a class="anchor" aria-label="anchor" href="#questions"></a>
</h2>
<p>Please email Keaka Farleigh (<a href="mailto:farleik@miamioh.edu" class="email">farleik@miamioh.edu</a>) if you need help generating a
q-matrix or with anything else.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaka Farleigh, Mason Murphy, Christopher Blair, Tereza Jezkova.</p>
</div>

<div class="pkgdown-footer-right">
  <p>PopGenHelpR is funded by an National Science Foundation (NSF) Graduate Research Fellowship and NSF Postdoctoral Research Fellowhip in Biology to KF (GRF, Award 2037786; PRFB, DBI-2409958), an NSF grant to CB (DEB-1929679), and an NSF career grant to TJ (DEB-2144047).</p>
</div>

    </footer>
</div>





  </body>
</html>
