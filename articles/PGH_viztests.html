<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PopGenHelpR function testing • PopGenHelpR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PopGenHelpR function testing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PopGenHelpR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Manual</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/PopGenHelpR_vignette.html">Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_benchmarking.html">Benchmarking</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_heterozygosity.html">Choosing heterozygosity</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_PCA.html">Principal Component Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_createQmatrix.html">Creating a Q-matrix</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_sortQmatrix.html">Sorting a Q-matrix</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_MakingMaps.html">Making Maps</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_plotformatting.html">Formatting plots</a></li>
    <li><a class="dropdown-item" href="../articles/PGH_viztests.html">Testing plotting arguments</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kfarleigh/PopGenHelpR"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PopGenHelpR function testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kfarleigh/PopGenHelpR/blob/main/vignettes/articles/PGH_viztests.Rmd" class="external-link"><code>vignettes/articles/PGH_viztests.Rmd</code></a></small>
      <div class="d-none name"><code>PGH_viztests.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>This document contains code and results from stress testing the
visualization functions of PopGenHelpR (PGH). This allows us to catch
any potential errors before publishing the new version of PGH to the
CRAN.</p>
<p><strong><em>!!! WARNING !!!</em></strong></p>
<p><strong><em>This document is not pretty, it exists to demonstrate
that we have tested many different combinations of arguments in our
functions and that they work as expected. Prettier documents can be
found in other articles on the <a href="https://kfarleigh.github.io/PopGenHelpR/">PopGenHelpR
website</a>.</em></strong></p>
<div class="section level3">
<h3 id="load-data-and-packages">Load data and packages<a class="anchor" aria-label="anchor" href="#load-data-and-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install developmental PopGenHelpR if needed </span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"kfarleigh/PopGenHelpR"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using github PAT from envvar GITHUB_PAT. Use `gitcreds::gitcreds_set()` and unset GITHUB_PAT in .Renviron (or elsewhere) if you want to use the more secure git credential store instead.</span></span></code></pre>
<pre><code><span><span class="co">## Downloading GitHub repo kfarleigh/PopGenHelpR@HEAD</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="color: #00BBBB;">R CMD build</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## * checking for file ‘/tmp/Rtmpz8o6By/remotes2b776cc47363/kfarleigh-PopGenHelpR-060c990/DESCRIPTION’ ... OK</span></span>
<span><span class="co">## * preparing ‘PopGenHelpR’:</span></span>
<span><span class="co">## * checking DESCRIPTION meta-information ... OK</span></span>
<span><span class="co">## * checking for LF line-endings in source and make files and shell scripts</span></span>
<span><span class="co">## * checking for empty or unneeded directories</span></span>
<span><span class="co">## * building ‘PopGenHelpR_1.4.0.tar.gz’</span></span></code></pre>
<pre><code><span><span class="co">## Installing package into '/home/runner/work/_temp/Library'</span></span>
<span><span class="co">## (as 'lib' is unspecified)</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"R --no-save"</span><span class="op">)</span> </span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kfarleigh.github.io/PopGenHelpR/">PopGenHelpR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Data</span></span>
<span></span>
<span><span class="va">Q_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/Q_dat.html">Q_dat</a></span></span>
<span><span class="va">Pop_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/HornedLizard_Pop.html">HornedLizard_Pop</a></span></span>
<span><span class="va">Fst_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/Fst_dat.html">Fst_dat</a></span></span>
<span><span class="va">Het_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/Het_dat.html">Het_dat</a></span></span>
<span></span>
<span></span>
<span><span class="co"># Spatial data</span></span>
<span><span class="va">shapefiles</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"PopGenHelpR"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"*.shp$"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove the viridis shapefile</span></span>
<span><span class="va">shapefiles</span> <span class="op">&lt;-</span> <span class="va">shapefiles</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Get elevation data </span></span>
<span><span class="va">raster</span> <span class="op">&lt;-</span> <span class="fu">geodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geodata/man/elevation.html" class="external-link">elevation_global</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get temperature data</span></span>
<span><span class="va">temp_ras</span> <span class="op">&lt;-</span> <span class="fu">geodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geodata/man/worldclim.html" class="external-link">worldclim_global</a></span><span class="op">(</span><span class="st">"tavg"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="ancestry-barchart">Ancestry barchart<a class="anchor" aria-label="anchor" href="#ancestry-barchart"></a>
</h4>
<p>We have updated the ancestry barchart to allow users to specify the
order of individuals/populations and to handle a mix of characters and
numeric information for the population and individual names. It also no
longer requires the population assignment file to be four columns, just
two (individual and population). The function also sorts
individuals/populations by cluster if no order is specified.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Isolate the q-matrix and population information, create Pop_mix to show it works with a mixture of character and numerics.</span></span>
<span><span class="va">Qmat</span> <span class="op">&lt;-</span> <span class="va">Q_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">Pops</span> <span class="op">&lt;-</span> <span class="va">Q_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">Pops_mix</span> <span class="op">&lt;-</span> <span class="va">Pops</span></span>
<span><span class="va">Pops_mix</span><span class="op">$</span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Pops_mix</span><span class="op">$</span><span class="va">Sample</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="generate-ancestry-matrices-with-mixed-individual-and-population-labels-">
<strong>Generate ancestry matrices with mixed individual and
population labels.</strong><a class="anchor" aria-label="anchor" href="#generate-ancestry-matrices-with-mixed-individual-and-population-labels-"></a>
</h5>
<p>First, we will show that using a mixture of character and numeric
labels does not make a difference, and that PGH now sorts the ancestry
matrix to cluster indviduals with similar ancestry together. We expect
these plots to look exactly the same.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run with no order specifiied</span></span>
<span><span class="va">Base</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mix_char_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops_mix</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base</span><span class="op">$</span><span class="va">`Individual Ancestry Plot`</span>, <span class="va">Mix_char_num</span><span class="op">$</span><span class="va">`Individual Ancestry Plot`</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-1-1.png" width="1000" height="750"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base</span><span class="op">$</span><span class="va">`Population Ancestry Plot`</span>, <span class="va">Mix_char_num</span><span class="op">$</span><span class="va">`Population Ancestry Plot`</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-1-2.png" width="1000" height="750"></p>
</div>
<div class="section level5">
<h5 id="generate-ancestry-matrices-of-specific-plot-types-">
<strong>Generate ancestry matrices of specific plot
types.</strong><a class="anchor" aria-label="anchor" href="#generate-ancestry-matrices-of-specific-plot-types-"></a>
</h5>
<p>Next, we will test the <code>plot.type</code> argument to ensure that
results are consistent regardless of plot.type.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure it works for only individual and population plot types </span></span>
<span></span>
<span><span class="va">Base_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_ind</span><span class="op">$</span><span class="va">`Individual Ancestry Matrix`</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-2-1.png" width="1000" height="750"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"population"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_pop</span><span class="op">$</span><span class="va">`Population Ancestry Matrix`</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-2-2.png" width="1000" height="750"></p>
</div>
<div class="section level5">
<h5 id="generate-ancestry-matrices-with-specific-individual-and-population-ordering-">
<strong>Generate ancestry matrices with specific individual and
population ordering.</strong><a class="anchor" aria-label="anchor" href="#generate-ancestry-matrices-with-specific-individual-and-population-ordering-"></a>
</h5>
<p>Finally, we will set individual, population, and both individual and
population orders for plotting to test the <code>ind.order</code> and
<code>pop.order</code> arguments. We expect the individual plots to go
<code>1-30</code> and for the population plots to go
<code>1-5</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order by individual, test when plot type is individual and all </span></span>
<span></span>
<span><span class="va">Base_ind_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"individual"</span>, ind.order <span class="op">=</span> <span class="va">Pops</span><span class="op">$</span><span class="va">Sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_ind_ord</span><span class="op">$</span><span class="va">`Individual Ancestry Matrix`</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-3-1.png" width="1000" height="750"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_ind_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, ind.order <span class="op">=</span> <span class="va">Pops</span><span class="op">$</span><span class="va">Sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_ind_ord</span><span class="op">$</span><span class="va">`Individual Ancestry Matrix`</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order by population, test when plot type is population and all </span></span>
<span></span>
<span><span class="va">Base_pop_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"population"</span>, pop.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Pops</span><span class="op">$</span><span class="va">Population</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_pop_ord</span><span class="op">$</span><span class="va">`Population Ancestry Matrix`</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-3-2.png" width="1000" height="750"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_pop_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, pop.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Pops</span><span class="op">$</span><span class="va">Population</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_pop_ord</span><span class="op">$</span><span class="va">`Population Ancestry Matrix`</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify both an individual and population order, this scenario is only relevant for plot type all</span></span>
<span></span>
<span><span class="va">Base_ind_pop_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ancestry_barchart.html">Ancestry_barchart</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, pop.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Pops</span><span class="op">$</span><span class="va">Population</span><span class="op">)</span>, ind.order <span class="op">=</span> <span class="va">Pops</span><span class="op">$</span><span class="va">Sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "All information needed is present, moving onto plotting."</span></span>
<span><span class="co">## [1] "Want to change the the text size, font, or any other formatting? See https://kfarleigh.github.io/PopGenHelpR/articles/PopGenHelpR_plotformatting.html for examples and help."</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Individual plot </span></span>
<span><span class="va">Base_ind_pop_ord</span><span class="op">$</span><span class="va">`Individual Ancestry Plot`</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-3-3.png" width="1000" height="750"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Population plot</span></span>
<span><span class="va">Base_ind_pop_ord</span><span class="op">$</span><span class="va">`Population Ancestry Plot`</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Ancestry%20barchart-3-4.png" width="1000" height="750"></p>
<p>Let’s move onto the <code>Piechart_map</code> function.</p>
</div>
</div>
<div class="section level4">
<h4 id="piechart-map">Piechart map<a class="anchor" aria-label="anchor" href="#piechart-map"></a>
</h4>
<p>Here, the new functionality is the ability to add shapefiles, a scale
bar, and a north arrow to the map. Users can change the position of the
shapefile, to be under boundaries (i.e., state lines), ontop of
boundaries, and ontop of everything. <strong>Note that the shapefiles do
not represent the ranges of the species piecharts that are being
plotted; this is only to demonstrate functionality.</strong> Also, if
the shapefile is on top of everything else, it will cause the coordinate
system to expand (plot will be sized differently).</p>
<div class="section level5">
<h5 id="generate-original-pgh-piechart-maps">
<strong>Generate original PGH piechart maps</strong><a class="anchor" aria-label="anchor" href="#generate-original-pgh-piechart-maps"></a>
</h5>
<p>First, we will generate piechart maps without extra layers, a north
arrow, or scale bar. We show that PGH works with differnt plot
types.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make map without shapefiles, this is what the original version of PGH did.</span></span>
<span><span class="va">Base_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base_piemap</span><span class="op">$</span><span class="va">Individual_piemap</span>, <span class="va">Base_piemap</span><span class="op">$</span><span class="va">Population_piemap</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Piechart%20map-1.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show it works for individual and population plot.types</span></span>
<span><span class="va">Base_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"individual"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Base_piemap</span><span class="op">$</span><span class="va">Individual_piemap</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Piechart%20map-2.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"population"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Base_piemap</span><span class="op">$</span><span class="va">Population_piemap</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Piechart%20map-3.png" width="1000" height="1250"></p>
</div>
<div class="section level5">
<h5 id="generate-pgh-piechart-maps-with-shapefiles-different-shapefile-positions">
<strong>Generate PGH piechart maps with shapefiles, different
shapefile positions</strong><a class="anchor" aria-label="anchor" href="#generate-pgh-piechart-maps-with-shapefiles-different-shapefile-positions"></a>
</h5>
<p>Now, we will add shapefiles to the plots and demonstrate how the
<code>shapefile_plot_position</code> argument works. We also demonstrate
how to plot transparent shapefiles that are outlined. <strong>It is
expected that you will receive a warning that the scale on the map
varies by more than 10%, scale bar may be inaccurate because the data
are not in a projected coordinate system</strong>. We do not support
projection of data within PGH because we do not want to decide which
projection is best for your project and because projecting large
shapefiles and rasters can crash R.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Try different shapefile positions</span></span>
<span><span class="va">Shap_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">Shap1_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>, north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Shap2_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Shap3_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">3</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span>
<span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Shap1_piemap</span><span class="op">$</span><span class="va">Population_piemap</span>, <span class="va">Shap2_piemap</span><span class="op">$</span><span class="va">Population_piemap</span>, <span class="va">Shap3_piemap</span><span class="op">$</span><span class="va">Population_piemap</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Piechart%20map-1-1.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Shap1_piemap</span><span class="op">$</span><span class="va">Individual_piemap</span>, <span class="va">Shap2_piemap</span><span class="op">$</span><span class="va">Individual_piemap</span>, <span class="va">Shap3_piemap</span><span class="op">$</span><span class="va">Individual_piemap</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Piechart%20map-1-2.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot with a transparent shapefile </span></span>
<span></span>
<span><span class="va">Shapoutlined_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">8</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shp_outwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Shapoutlined_piemap</span><span class="op">$</span><span class="va">Individual_piemap</span>, <span class="va">Shapoutlined_piemap</span><span class="op">$</span><span class="va">Population_piemap</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Piechart%20map-1-3.png" width="1000" height="1250"></p>
<p>The <code>Piechart_map</code> function also seems to work. Let’s move
onto the <code>Plot_coordinates</code> function.</p>
</div>
</div>
<div class="section level4">
<h4 id="plot-coordinates">Plot coordinates<a class="anchor" aria-label="anchor" href="#plot-coordinates"></a>
</h4>
<p>Users can now add shapefiles and rasters to the maps output by
<code>Plot_coordinates</code>, along with north arrows and scale bars.
Now, they can also change the colors of the points based on group
assignment.</p>
<p>First, we will generate a plot with points and no raster or shapefile
as a base layer. We can generate a map where poitns are all the same
color (no <code>group</code> or <code>group_col</code> argument) or a
map where points are colored by specifying the <code>group</code> or
<code>group_col</code> arguments.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_PC_nogrp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Pop_dat</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Base_PC_wgrp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Pop_dat</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>,  group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base_PC_nogrp</span>, <span class="va">Base_PC_wgrp</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Plot%20Coordinates-1.png" width="1000" height="1250"></p>
<p>Now, let’s add a shapefile, scale bar, and north arrow.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PC_shp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Pop_dat</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>,  group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_shp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Pop_dat</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>,  group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_shp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Pop_dat</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>,  group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">3</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PC_shpout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Pop_dat</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>,  group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">8</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">3</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PC_shp1</span>, <span class="va">PC_shp2</span>, <span class="va">PC_shp3</span>, <span class="va">PC_shpout</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Plot%20Coordinates-1-1.png" width="1000" height="1250"></p>
<p>Now, let’s add a raster. <strong>Sometimes <code>terra</code>
interprets rasters as discrete, even though they are not. We have added
the <code>disrete_raster</code> argument to accomodate this, but fair
warning that it can throw an error the first time you try your
raster</strong>. The solution is just to change the
<code>discrete_raster</code> argument to TRUE or FALSE (depending on
what failed).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PC_ras1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_ras2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_ras3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">3</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PC_ras1</span>, <span class="va">PC_ras2</span>, <span class="va">PC_ras3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Plot%20Coordinates-2-1.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PC_temp</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">3</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_temp_wbreaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">temp_ras</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">0</span>,<span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PC_temp</span>, <span class="va">PC_temp_wbreaks</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Plot%20Coordinates-2-2.png" width="1000" height="1250"></p>
<p>Finally, we will create the map with a raster and shapefiles.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PC_ras_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>,    raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_ras_shp</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Plot%20Coordinates-3-1.png" width="1000" height="1250"></p>
</div>
<div class="section level4">
<h4 id="point-map">Point map<a class="anchor" aria-label="anchor" href="#point-map"></a>
</h4>
<p>Users can now add shapefiles and rasters to the maps output by
<code>Point_map</code>, along with north arrows and scale bars.</p>
<p>First, we will just make a <code>Point_map</code> map with no
background, just the regular basemap and administrative boundaries.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_PM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set an outline color</span></span>
<span><span class="va">Base_PM_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, out.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base_PM</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">Base_PM_out</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Point%20map-1-1.png" width="1000" height="1250"></p>
<p>Now let’s add shapefiles, a scale bar, and north arrow.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PM_shp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span>, out.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM_shp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span>, out.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM_shp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">3</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span>, out.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PM_shpout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">8</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">3</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, out.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PM_shp1</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">PM_shp2</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">PM_shp3</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">PM_shpout</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Point%20map-2-1.png" width="1000" height="1250"></p>
<p>Next, let’s add a raster. Remember that funky things can happen with
<code>terra</code> interpreting your raster as discrete or continous.
Use the <code>discrete_raster</code> arugment to get around this.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PM_ras1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span><span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM_ras2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span><span class="va">Het_dat</span>,  statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM_ras3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span><span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>,  Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">3</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PM_ras1</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">PM_ras2</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">PM_ras3</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Point%20map-3-1.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PM_temp</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span><span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>,  Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">3</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM_temp_wbreaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span><span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">temp_ras</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">0</span>,<span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PM_temp</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span>, <span class="va">PM_temp_wbreaks</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Point%20map-3-2.png" width="1000" height="1250"></p>
<p>Finally, add shapefiles and a raster.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PM_ras_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Point_map.html">Point_map</a></span><span class="op">(</span><span class="va">Het_dat</span>, statistic <span class="op">=</span> <span class="st">"Heterozygosity"</span>, Longitude_col <span class="op">=</span> <span class="fl">4</span>, Latitude_col <span class="op">=</span> <span class="fl">5</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>,    raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span>, shp_outwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PM_ras_shp</span><span class="op">$</span><span class="va">`Heterozygosity Map`</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Point%20map-4-1.png" width="1000" height="1250"></p>
</div>
<div class="section level4">
<h4 id="network-map">Network map<a class="anchor" aria-label="anchor" href="#network-map"></a>
</h4>
<p>Users can now add shapefiles and rasters to the maps output by
<code>Network_map</code>, along with north arrows and scale bars. This
function has also been updated to fix a bug that removed sites if they
had a statistic of 0 (i.e, Fst = 0). Originally, this was to remove
localities mapping with themselves; now we remove these instances using
matching names.</p>
<p>First, let’s create a basic map with just the edges and point.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_NM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>,country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_NM</span><span class="op">$</span><span class="va">Map</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Network%20map-1-1.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify a comparison using population names</span></span>
<span></span>
<span><span class="va">Base_NM_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, neighbors <span class="op">=</span> <span class="st">"South_West"</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>,country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base_NM</span><span class="op">$</span><span class="va">Map</span>, <span class="va">Base_NM_comp</span><span class="op">$</span><span class="va">Map</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Network%20map-1-2.png" width="1000" height="1250"></p>
<p>Now, let’s add a shapefile, scale bar, and north arrow.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>,country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>,country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>,country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">3</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shapefile_outline_col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>,country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shp_outwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">NM_1</span><span class="op">$</span><span class="va">Map</span>, <span class="va">NM_2</span><span class="op">$</span><span class="va">Map</span>, <span class="va">NM_3</span><span class="op">$</span><span class="va">Map</span>, <span class="va">NM_4</span><span class="op">$</span><span class="va">Map</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Network%20map-2-1.png" width="1000" height="1250"></p>
<p>Next, let’s add a raster.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_ras1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_ras2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>,neighbors <span class="op">=</span> <span class="fl">2</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_ras3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>,  neighbors <span class="op">=</span> <span class="fl">2</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">3</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">NM_ras1</span><span class="op">$</span><span class="va">Map</span>, <span class="va">NM_ras2</span><span class="op">$</span><span class="va">Map</span>, <span class="va">NM_ras3</span><span class="op">$</span><span class="va">Map</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Network%20map-3-1.png" width="1000" height="1250"></p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_temp</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,  statistic <span class="op">=</span> <span class="st">"Fst"</span>,  neighbors <span class="op">=</span> <span class="fl">2</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_temp_wbreaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, neighbors <span class="op">=</span> <span class="fl">2</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">temp_ras</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">0</span>,<span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">NM_temp</span><span class="op">$</span><span class="va">Map</span>, <span class="va">NM_temp_wbreaks</span><span class="op">$</span><span class="va">Map</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Network%20map-3-2.png" width="1000" height="1250"></p>
<p>Finally, let’s make a map with both a shapefile and raster.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_ras_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Network_map.html">Network_map</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, pops <span class="op">=</span> <span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,  statistic <span class="op">=</span> <span class="st">"Fst"</span>,  neighbors <span class="op">=</span> <span class="fl">2</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#8c510a'</span>,<span class="st">'#d8b365'</span>,<span class="st">'#f6e8c3'</span>,<span class="st">'#f5f5f5'</span>,<span class="st">'#c7eae5'</span>,<span class="st">'#5ab4ac'</span>,<span class="st">'#01665e'</span><span class="op">)</span>,    raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"right"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span>, shp_outwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in spdep::knearneigh(Coords, k = neighbors, longlat = TRUE, use_kd_tree</span></span>
<span><span class="co">## = FALSE): k greater than one-third of the number of data points</span></span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NM_ras_shp</span><span class="op">$</span><span class="va">Map</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre>
<p><img src="PGH_viztests_files/figure-html/Network%20map-4-1.png" width="1000" height="1250"></p>
</div>
<div class="section level4">
<h4 id="pairwise-heatmap">Pairwise heatmap<a class="anchor" aria-label="anchor" href="#pairwise-heatmap"></a>
</h4>
<p>Users now have more freedom to control the color gradient.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Base_PH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pairwise_heatmap.html">Pairwise_heatmap</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PH_wbreaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pairwise_heatmap.html">Pairwise_heatmap</a></span><span class="op">(</span><span class="va">Fst_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, statistic <span class="op">=</span> <span class="st">"Fst"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.225</span>,<span class="fl">0.25</span>,<span class="fl">0.3</span>,<span class="fl">0.38</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Base_PH</span>, <span class="va">PH_wbreaks</span><span class="op">)</span></span></code></pre></div>
<p><img src="PGH_viztests_files/figure-html/Pairwise%20heatmap%20-1.png" width="1000" height="1250"></p>
<p><strong>Thank you for your interest in our package and for reading
through all of this. Please reach out if you have any questions or
suggestions that could help make the package better.</strong></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaka Farleigh, Mason Murphy, Christopher Blair, Tereza Jezkova.</p>
</div>

<div class="pkgdown-footer-right">
  <p>PopGenHelpR is funded by an National Science Foundation (NSF) Graduate Research Fellowship and NSF Postdoctoral Research Fellowhip in Biology to KF (GRF, Award 2037786; PRFB, DBI-2409958), an NSF grant to CB (DEB-1929679), and an NSF career grant to TJ (DEB-2144047).</p>
</div>

    </footer>
</div>





  </body>
</html>
