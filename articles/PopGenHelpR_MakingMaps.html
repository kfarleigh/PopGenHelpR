<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Making Maps with PopGenHelpR • PopGenHelpR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Making Maps with PopGenHelpR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PopGenHelpR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Manual</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/PopGenHelpR_vignette.html">Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_heterozygosity.html">Choosing heterozygosity</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_PCA.html">Principal Component Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_createQmatrix.html">Creating a Q-matrix</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_sortQmatrix.html">Sorting a Q-matrix</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_MakingMaps.html">Making Maps</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_plotformatting.html">Formatting plots</a></li>
    <li><a class="dropdown-item" href="../articles/PopGenHelpR_benchmarking.html">Testing PopGen statistics</a></li>
    <li><a class="dropdown-item" href="../articles/PGH_viztests.html">Testing plotting arguments</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kfarleigh/PopGenHelpR"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Making Maps with PopGenHelpR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kfarleigh/PopGenHelpR/blob/main/vignettes/articles/PopGenHelpR_MakingMaps.Rmd" class="external-link"><code>vignettes/articles/PopGenHelpR_MakingMaps.Rmd</code></a></small>
      <div class="d-none name"><code>PopGenHelpR_MakingMaps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>This document contains code to demonstrate how to use PopGenHelpR to
create maps. The examples provdied are not comprehensive, but they
should give you a solid foundation. Please reach out if you have any
questions or need any help.</p>
<div class="section level3">
<h3 id="how-do-maps-work-in-popgenhelpr">How do maps work in PopGenHelpR?<a class="anchor" aria-label="anchor" href="#how-do-maps-work-in-popgenhelpr"></a>
</h3>
<p>Maps in PopGenHelpR are built using
<code>[ggplot2](https://ggplot2.tidyverse.org/)</code>,
<code>[terra](https://rspatial.github.io/terra/)</code>,
<code>[sf](https://cran.r-project.org/web/packages/sf/index.html)</code>,
<code>[geodata](https://cran.r-project.org/web/packages/geodata/index.html)</code>,
and <code>[ggspatial](https://paleolimbot.github.io/ggspatial/)</code>.
PopGenHelpR uses these packages to build maps in layers, that are
stacked on top of each other to create our final maps. Without
shapefiles and rasters, PopGenHelpR will just plot your data (i.e.,
coordinates, piecharts) on top of a basemap, which may or may not
include administrative borders (i.e., states). Then, when users add
shapefiles or a raster (<code>shapefile</code> and <code>raster</code>
arguments, respectively) we can manipulate the relationship of those
layers using the <code>shapefile_plot_position</code> and
<code>raster_plot_position</code> arguments. We have created a
visualization to help users understand the <code>plot_position</code>
arguments in different scenarios (see figure below).</p>
<p><img src="MapLayer_Arguments.jpg" width="600px" height="400px" style="display: block; margin: auto;"></p>
<p>Conveniently, users can include any administrative borders in the
<code>geodata</code> package using the <code>country_code</code>
argument. This expands the utility of PopGenHelpR by providing data for
the entire world, not just the United States of America. Users can also
add a scale bar and north arrow (you can change the style, see below).
Altogether, this allows users to create publication quality maps without
the need for expensive liscences or subscriptions.</p>
<div class="section level4">
<h4 id="notes-on-popgenhelpr-maps">Notes on PopGenHelpR maps<a class="anchor" aria-label="anchor" href="#notes-on-popgenhelpr-maps"></a>
</h4>
<p>There are a few things to be aware of with PopGenHelpR’s mapping
functions.</p>
<ol style="list-style-type: decimal">
<li>You will get an inaccurate scale warning. This is expected because
we are using unprojected data. If this causes serious concern please
email us for help. We do not provide support for projecting data because
projection can cause R to crash and can be done in
<code>terra</code>.</li>
<li>Your raster may be recognized as discrete or continous when it is
not. This error comes from <code>terra</code>, we provide the
<code>discrete_raster</code> argument to accommodate this. Just set it
to TRUE or FALSE.</li>
<li>The <code>Piechart_map</code> function does not support rasters.
This is because ggplot2 can only take one <code>scale_fill</code> per
plot. With a raster, we would need two <code>scale_fills</code>. This is
also why there is no outline on the <code>Point_map</code> plots that
include a raster.</li>
</ol>
<p>Let’s make a few maps!</p>
</div>
</div>
<div class="section level3">
<h3 id="load-data-and-packages">Load data and packages<a class="anchor" aria-label="anchor" href="#load-data-and-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Install developmental PopGenHelpR if needed </span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"kfarleigh/PopGenHelpR"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using github PAT from envvar GITHUB_PAT. Use `gitcreds::gitcreds_set()` and unset GITHUB_PAT in .Renviron (or elsewhere) if you want to use the more secure git credential store instead.</span></span>
<span><span class="co">#&gt; Skipping install of 'PopGenHelpR' from a github remote, the SHA1 (bdcfb5f7) has not changed since last install.</span></span>
<span><span class="co">#&gt;   Use `force = TRUE` to force installation</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"R --no-save"</span><span class="op">)</span> </span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kfarleigh.github.io/PopGenHelpR/">PopGenHelpR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data</span></span>
<span></span>
<span><span class="va">Q_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/Q_dat.html">Q_dat</a></span></span>
<span><span class="va">Pop_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/HornedLizard_Pop.html">HornedLizard_Pop</a></span></span>
<span><span class="va">Fst_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/Fst_dat.html">Fst_dat</a></span></span>
<span><span class="va">Het_dat</span> <span class="op">&lt;-</span> <span class="fu">PopGenHelpR</span><span class="fu">::</span><span class="va"><a href="../reference/Het_dat.html">Het_dat</a></span></span>
<span></span>
<span><span class="co"># Isolate the q-matrix and population information, create Pop_mix to show it works with a mixture of character and numerics.</span></span>
<span><span class="va">Qmat</span> <span class="op">&lt;-</span> <span class="va">Q_dat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">Pops</span> <span class="op">&lt;-</span> <span class="va">Q_dat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Spatial data</span></span>
<span><span class="va">shapefiles</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"PopGenHelpR"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"*.shp$"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove the viridis shapefile</span></span>
<span><span class="va">shapefiles</span> <span class="op">&lt;-</span> <span class="va">shapefiles</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Get elevation data </span></span>
<span><span class="va">raster</span> <span class="op">&lt;-</span> <span class="fu">geodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geodata/man/elevation.html" class="external-link">elevation_global</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get temperature data</span></span>
<span><span class="va">temp_ras</span> <span class="op">&lt;-</span> <span class="fu">geodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geodata/man/worldclim.html" class="external-link">worldclim_global</a></span><span class="op">(</span><span class="st">"tavg"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="piechart_map-with-shapefiles">
<code>Piechart_map</code> with shapefiles<a class="anchor" aria-label="anchor" href="#piechart_map-with-shapefiles"></a>
</h4>
<p>First, let’s make a piechart map with shapefiles.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Shap2_piemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#9e0142'</span>,<span class="st">'#d53e4f'</span>,<span class="st">'#f46d43'</span>,<span class="st">'#fdae61'</span>,<span class="st">'#abdda4'</span>,<span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Shap2_piemap</span><span class="op">$</span><span class="va">Population_piemap</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre></div>
<p><img src="PopGenHelpR_MakingMaps_files/figure-html/Piechart%20map-1.png" width="1250" height="1500"></p>
<p>That’s great, but what about if we want the shapefiles to be
transparent and outlined with the colors? We will set the
<code>shapefile_col = NA</code>, use the colors in
<code>shapefile_outline_col</code>, and set the
<code>shp_outwidth=1.5</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Shap2_piemap_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="cn">NA</span>, shapefile_outline_col <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#9e0142'</span>,<span class="st">'#d53e4f'</span>,<span class="st">'#f46d43'</span>,<span class="st">'#fdae61'</span>,<span class="st">'#abdda4'</span>,<span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, shp_outwidt <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Shap2_piemap_out</span><span class="op">$</span><span class="va">Population_piemap</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre></div>
<p><img src="PopGenHelpR_MakingMaps_files/figure-html/Piechart%20map-1-1.png" width="1250" height="1500"></p>
<p>Nice, now let’s compare them to see how they are different. We will
use the <code>plot_grid</code> function from <code>cowplot</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Shap2_piemap</span><span class="op">$</span><span class="va">Population_piemap</span>, <span class="va">Shap2_piemap_out</span><span class="op">$</span><span class="va">Population_piemap</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre></div>
<p><img src="PopGenHelpR_MakingMaps_files/figure-html/Piechart%20map-2-1.png" width="1250" height="1500"></p>
</div>
</div>
<div class="section level3">
<h3 id="plot_coordinates-with-raster">
<code>Plot_coordinates</code> with raster<a class="anchor" aria-label="anchor" href="#plot_coordinates-with-raster"></a>
</h3>
<p>Well, what about rasters? Or both rasters and shapfiles? Let’s make a
couple of maps. We will create a map with points on top of a raster, a
raster on top of everything to demonstrate the
<code>raster_plot_position</code> argument, and a plot with shapfiles
and rasters to show you how the <code>shapefile_plot_position</code> and
<code>raster_plot_position</code> behave together. **Hint, you can plot
rasters and shapefiles on top of everything else to create a map with
only those layers.</p>
<p>We will use elevation data from the <code>geodata</code> package as
our raster.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">PC_ras1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">1</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"none"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_ras3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">3</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>,    </span>
<span>raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"none"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">PC_ras1</span>, <span class="va">PC_ras3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre></div>
<p><img src="PopGenHelpR_MakingMaps_files/figure-html/Plot%20Coordinates-1-1.png" width="1250" height="1500"></p>
<p>Now, we will make a map with shapefiles and a raster. Notice that the
shapefile is on top of the raster and that the
<code>raster_plot_position</code> argument does not matter. This is
because <code>PopGenHelpR</code> uses the
<code>shapefile_plot_position</code> arugment to determine the placement
of these layers when both a shapefile and raster are provided.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">PC_ras_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Plot_coordinates.html">Plot_coordinates</a></span><span class="op">(</span><span class="va">Pop_dat</span>, Longitude_col <span class="op">=</span> <span class="fl">3</span>, Latitude_col <span class="op">=</span> <span class="fl">4</span>, group <span class="op">=</span> <span class="va">Pop_dat</span><span class="op">$</span><span class="va">Population</span>, group_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"mex"</span>, <span class="st">"can"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">1</span>, raster <span class="op">=</span> <span class="va">raster</span>, raster_plot_position <span class="op">=</span> <span class="fl">2</span>, interpolate_raster <span class="op">=</span> <span class="cn">TRUE</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, discrete_raster <span class="op">=</span> <span class="cn">TRUE</span>, shapefile_outline_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#9e0142'</span>,<span class="st">'#d53e4f'</span>,<span class="st">'#f46d43'</span>,<span class="st">'#fdae61'</span>,<span class="st">'#abdda4'</span>,<span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>,   raster_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'#ffffcc'</span>,<span class="st">'#ffeda0'</span>,<span class="st">'#fed976'</span>,<span class="st">'#feb24c'</span>,<span class="st">'#fd8d3c'</span>,<span class="st">'#fc4e2a'</span>,<span class="st">'#e31a1c'</span>,<span class="st">'#bd0026'</span>,<span class="st">'#800026'</span><span class="op">)</span>, raster_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">500</span>,<span class="fl">1000</span>,<span class="fl">1500</span>,<span class="fl">2000</span>,<span class="fl">2500</span>,<span class="fl">3000</span>,<span class="fl">3500</span>,<span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>, legend_pos <span class="op">=</span> <span class="st">"none"</span>, scale_bar <span class="op">=</span> <span class="cn">TRUE</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>, north_arrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PC_ras_shp</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre></div>
<p><img src="PopGenHelpR_MakingMaps_files/figure-html/Plot%20Coordinates-3-1.png" width="1250" height="1500"></p>
<div class="section level4">
<h4 id="changing-the-north-arrow-">Changing the north arrow.<a class="anchor" aria-label="anchor" href="#changing-the-north-arrow-"></a>
</h4>
<p>Finally, we will change the north arrow style using the
<code>north_arrow_style</code> argument. By default, it is
<code>north_arrow_style = ggspatial::north_arrow_nautical()</code>.
Let’s change it to
<code>north_arrow_style =north_arrow_orienteering()</code> and compare
the two.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Shap2_piemap_arrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#9e0142'</span>,<span class="st">'#d53e4f'</span>,<span class="st">'#f46d43'</span>,<span class="st">'#fdae61'</span>,<span class="st">'#abdda4'</span>,<span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>,  north_arrow_style <span class="op">=</span> <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/north_arrow_orienteering.html" class="external-link">north_arrow_nautical</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Shap2_piemap_arrow2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Piechart_map.html">Piechart_map</a></span><span class="op">(</span>anc.mat <span class="op">=</span> <span class="va">Qmat</span>, pops <span class="op">=</span> <span class="va">Pops</span>, K <span class="op">=</span> <span class="fl">5</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#d73027'</span>, <span class="st">'#fc8d59'</span>, <span class="st">'#e0f3f8'</span>, <span class="st">'#91bfdb'</span>, <span class="st">'#4575b4'</span><span class="op">)</span>, plot.type <span class="op">=</span> <span class="st">"all"</span>, Lat_buffer <span class="op">=</span> <span class="fl">3</span>, Long_buffer <span class="op">=</span> <span class="fl">3</span>, country_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"usa"</span>, <span class="st">"can"</span>, <span class="st">"mex"</span><span class="op">)</span>, shapefile <span class="op">=</span> <span class="va">shapefiles</span>, shapefile_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#9e0142'</span>,<span class="st">'#d53e4f'</span>,<span class="st">'#f46d43'</span>,<span class="st">'#fdae61'</span>,<span class="st">'#abdda4'</span>,<span class="st">'#66c2a5'</span>,<span class="st">'#3288bd'</span>,<span class="st">'#5e4fa2'</span><span class="op">)</span>, shapefile_plot_position <span class="op">=</span> <span class="fl">2</span>,north_arrow <span class="op">=</span> <span class="cn">T</span>, scale_bar <span class="op">=</span> <span class="cn">T</span>, north_arrow_position <span class="op">=</span> <span class="st">"tr"</span>,  north_arrow_style <span class="op">=</span> <span class="fu">ggspatial</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/north_arrow_orienteering.html" class="external-link">north_arrow_orienteering</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">Shap2_piemap_arrow</span><span class="op">$</span><span class="va">Population_piemap</span>, <span class="va">Shap2_piemap_arrow2</span><span class="op">$</span><span class="va">Population_piemap</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span>
<span><span class="co">#&gt; Scale on map varies by more than 10%, scale bar may be inaccurate</span></span></code></pre></div>
<p><img src="PopGenHelpR_MakingMaps_files/figure-html/Arrow-1.png" width="1250" height="1500"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaka Farleigh, Mason Murphy, Christopher Blair, Tereza Jezkova.</p>
</div>

<div class="pkgdown-footer-right">
  <p>PopGenHelpR is funded by an National Science Foundation (NSF) Graduate Research Fellowship and NSF Postdoctoral Research Fellowhip in Biology to KF (GRF, Award 2037786; PRFB, DBI-2409958), an NSF grant to CB (DEB-1929679), and an NSF career grant to TJ (DEB-2144047).</p>
</div>

    </footer>
</div>





  </body>
</html>
